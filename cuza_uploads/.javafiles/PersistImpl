/*
 * Builds the Query
 */
package persistlayer;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.util.ArrayList;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import logiclayer.LogicImpl;
import persistlayer.DbAccessImpl;

public class PersistImpl {
	//Class Instances
		DbAccessImpl db = new DbAccessImpl ();
		Connection con = db.connect();
		LogicImpl logic = new LogicImpl();
	
	/* Query Result = User Full Name */
	public String findUserFullName(String username){
		String query = "SELECT first_name,last_name FROM students s JOIN user_info u on u.student_id=s.id where u.username="+"'"+username.toLowerCase()+"'";
		ResultSet rset = db.retrieve(con, query); //execute query
		return logic.getFullName(rset);
	}
	
	/* Query Result = User's interests */
	public String findUserInterests(String username){
		String query = "SELECT interest FROM student_interest join user_info u where u.username="+"'"+username.toLowerCase()+"'";
		ResultSet rset = db.retrieve(con, query); //execute query
		return logic.getresults(rset);
	}
	
	/* Query Result = User's clubs */
	public String findUserClubs(String username){
		String query = "SELECT club FROM student_club s join user_info u where u.username="+"'"+username.toLowerCase()+"'";
		ResultSet rset = db.retrieve(con, query); //execute query
		return logic.getresults(rset);
	}
}//class
